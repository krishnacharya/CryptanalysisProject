import sys
from sage.all import *
from tqdm import tqdm
# N is 2052 bit long, 

N = ZZ(int('''2642815425901590293560897488912722319556533908119969449002605923497863983308299
6144835489977969646168563452443542522292691290596215841754516642459273318557797
7759316121768584362425272409014052639676778985766113063317512207456970318590307
6838389250811571463028846098146648036451870901715049416356848547386440134766320
2460522140396019233424593452690435532460026536067953900137408198762179014665720
1096025378770233470383970102781325591629292365139475970224294858059230403654763
4161527563784726842046443603131308926756434398995928936032559265301172319973566
61350759298228510599507660377993360507002371881622197065049932987'''.replace("\n","")))

qbar = ZZ(int('''3018590329916106903745950161275822102186792168462972683821507802033552387294630
1938053575955400221735067890965825658069724406927120922045769729509411690034'''.replace("\n","")))

r = 3 

P.<x> = PolynomialRing(Zmod(N), implementation = 'NTL')
re = 0
for b in range(1e6):
	f = (x + qbar + re)**r
	d = f.small_roots(X = 2**320-1, beta=0.33)
	if (d != []) and  (ZZ(d[0]) != ZZ(N)) and (ZZ(N) % ZZ(d[0]) == 0):
		break
	if b % 1000 == 0:
		print b/1e6
	re = ZZ.random_element(0, 2**320)